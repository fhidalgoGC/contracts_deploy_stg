const login = async (email: string, password: string): Promise<boolean> => {
    try {
      setError(null);
      setIsLoading(true);
      const result = await loginMutation({ email, password }).unwrap();

      // Store tokens in localStorage
      localStorage.setItem("jwt", result.id_token);
      localStorage.setItem("id_token", result.id_token); // Also store as id_token for characteristics endpoint
      localStorage.setItem("refresh_token", result.refresh_token);
      localStorage.setItem("access_token", result.access_token);

      // After successful login, fetch user identity using organization service
      const { organizationService } = await import(
        "@/services/organization.service"
      );
      const identityData = await (organizationService as any).getCustomerInfo();

      // Store user data in localStorage and context
      localStorage.setItem("user_name", identityData.data.firstName);
      localStorage.setItem("user_lastname", identityData.data.lastName);
      localStorage.setItem("user_id", identityData.data.id);
      localStorage.setItem("customer_id", identityData.data.id); // Store customer_id for organization service
      localStorage.setItem("user_email", identityData.data.email);
      
      // Update user context
      setUserData({
        userName: identityData.data.firstName,
        userId: identityData.data.id
      });

      // Get partition keys using organization service
      const partitionKeysData = await organizationService.getPartitionKeys();

      // Store partition key from the first object in the array and store organization options
      let partitionKey = "";
      if (partitionKeysData && partitionKeysData.length > 0) {
        const firstOrg = partitionKeysData[0];
        partitionKey = firstOrg.value;
        localStorage.setItem("partition_key", partitionKey);

        // Store current organization info for navbar menu
        localStorage.setItem("current_organization_id", firstOrg.value);
        localStorage.setItem("current_organization_name", firstOrg.label);

        // Store all organization options for the menu
        localStorage.setItem(
          "organization_options",
          JSON.stringify(partitionKeysData),
        );